// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model StoreSettings {
  id                    Int      @id @default(autoincrement())
  businessName          String?
  logoUrl               String?
  primaryColor          String?  @default("#111827")
  secondaryColor        String?  @default("#f3f4f6")
  businessEmail         String?
  businessPhone         String?
  businessAddress       String?
  businessCity          String?
  businessState         String?
  businessZip           String?
  businessCountry       String?
  aboutText             String?
  heroHeadline          String?
  heroSubheadline       String?
  heroImageUrl          String?
  openingHours          String?
  facebookUrl           String?
  instagramUrl          String?
  twitterUrl            String?
  tiktokUrl             String?
  stripeSecretKey       String?
  stripePublishableKey  String?
  showHomepage          Boolean  @default(true)
  showProductList       Boolean  @default(true)
  showSearch            Boolean  @default(true)
  showAccountArea       Boolean  @default(true)
  showContactPage       Boolean  @default(true)
  showLocationPage      Boolean  @default(true)
  showBlog              Boolean  @default(true)
  showFAQ               Boolean  @default(true)
  shippingMode          String   @default("flat")
  flatShippingRateCents Int      @default(0)
  flatShippingLabel     String?  @default("Standard Shipping")
  updatedAt             DateTime @updatedAt
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  passwordHash String
  isAdmin      Boolean  @default(false)
  createdAt    DateTime @default(now())
  orders       Order[]
}

model Product {
  id          Int         @id @default(autoincrement())
  name        String
  slug        String      @unique
  description String?
  basePrice   Int
  images      String
  isActive    Boolean     @default(true)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  variants    Variant[]
  orderItems  OrderItem[]
}

model Variant {
  id        Int     @id @default(autoincrement())
  productId Int
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  name      String
  sku       String? @unique
  price     Int?
  stock     Int     @default(0)
  isActive  Boolean @default(true)
}

model Order {
  id                    Int         @id @default(autoincrement())
  userId                Int?
  user                  User?       @relation(fields: [userId], references: [id])
  email                 String
  totalCents            Int
  currency              String
  status                String      @default("pending")
  stripeSessionId       String      @unique
  stripePaymentIntentId String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt
  items                 OrderItem[]
  shippingName          String?
  shippingAddress       String?
}

model OrderItem {
  id             Int     @id @default(autoincrement())
  orderId        Int
  order          Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  productId      Int
  product        Product @relation(fields: [productId], references: [id])
  variantId      Int?
  quantity       Int
  unitPriceCents Int
}

model BlogPost {
  id        Int      @id @default(autoincrement())
  title     String
  slug      String   @unique
  content   String
  published Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model FAQ {
  id       Int    @id @default(autoincrement())
  question String
  answer   String
  order    Int    @default(0)
}
